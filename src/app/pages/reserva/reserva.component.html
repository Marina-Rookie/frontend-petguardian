<div class="row">
  <h2>
    Tus reservas
  </h2>
  <div class="mt-4">
    <nz-table [nzData]="reservas">
      <thead>
        <tr>
          <th>Fecha Inicio</th>
          <th>Fecha Fin</th>
          <th>Estado</th>
          <th>Cuidador</th>
          <th>Mascotas</th>
          <th>Precio</th>
          <th>Puntuacion</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        @for (reserva of reservas; track reserva._id) {
          <tr>
            <td>{{reserva.fechaInicio | date: 'dd-MM-yyyy'}}</td>
            <td>{{reserva.fechaFin | date: 'dd-MM-yyyy'}}</td>
            <td>{{reserva.estado.estado}}</td>
            <td>{{reserva.cuidador.nombre}}</td>
            <td>@for(m of reserva.mascotas; track m){
                {{m.nombre}}
            }
            </td>
            <td>${{reserva.tarifaTurno * reserva.contadorTurnos}}</td>
            <td class="text-center">
              5
              <span nz-icon nzType="star" nzTheme="outline"></span>
            </td>
            <td class="text-center">
              @if (reserva.estado.estado == 'Finalizada') {
                <button nz-button nzType="default" (click)="openModal(reserva)">Reseñar</button>
              }
              @if (reserva.estado.estado == 'Pendiente') {
                <button nz-button nzType="default" nzDanger (click)="cancelarReserva(reserva)">Cancelar</button>
              }
            </td>
          </tr>
        }
      </tbody>
    </nz-table>
  </div>
</div>
<nz-modal [(nzVisible)]="isVisible" nzTitle="Reseñar cuidador" (nzOnCancel)="handleCancel()" (nzOnOk)="handleOk()">
  <ng-container *nzModalContent>
    <div>
      Puntuacion:
      <nz-rate [(ngModel)]="puntuacion" [nzAllowHalf]="true"></nz-rate>
    </div>
    <div class="mt-2">
      Comentario:
      <nz-input [(ngModel)]="comentario" ></nz-input>
    </div>
  </ng-container>
</nz-modal>
